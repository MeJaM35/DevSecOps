{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Statistics Cards -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <!-- Total Expenses Card -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Total Expenses</h3>
                <p class="text-2xl font-bold text-gray-900">₹{{ total_expenses|floatformat:2 }}</p>
            </div>
            
            <!-- Monthly Average Card -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Monthly Average</h3>
                <p class="text-2xl font-bold text-gray-900">₹{{ monthly_average|floatformat:2 }}</p>
            </div>

            <!-- Date Range Selector -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Time Period</h3>
                <form method="GET">
                    <select name="date_range" onchange="this.form.submit()" class="block w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="7" {% if date_range == '7' %}selected{% endif %}>Last 7 days</option>
                        <option value="30" {% if date_range == '30' %}selected{% endif %}>Last 30 days</option>
                        <option value="90" {% if date_range == '90' %}selected{% endif %}>Last 3 months</option>
                        <option value="365" {% if date_range == '365' %}selected{% endif %}>Last year</option>
                    </select>
                </form>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Category Chart -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Expenses by Category</h3>
                <div class="relative" style="height: 400px;">
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>
            
            <!-- Spent By Chart -->
            <div class="bg-white rounded-lg shadow p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Expenses by Spender</h3>
                <div class="relative" style="height: 400px;">
                    <canvas id="spentByChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Loading the latest Chart.js version -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
<script src="{% static 'js/stats.js' %}"></script>
{% endblock %}